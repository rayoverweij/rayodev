---
import "../styles/global.css";
import Analytics from "@vercel/analytics/astro";
import SpeedInsights  from "@vercel/speed-insights/astro";


interface Props {
	title: string;
	desc: string;
	image: string;
	imageAlt: string;
	bg?: "white" | "rock";
}

const { title, desc, image, imageAlt, bg } = Astro.props;
---

<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, minimum-scale=1" />
		
		<title>{ title } | Rayo Verweij</title>
		<meta name="description" content={desc} />
		<meta property="og:title" content={title} />
		<meta property="og:type" content="website" />
		<meta property="og:image" content={image} />
		<meta property="og:image:alt" content={imageAlt} />
		<meta property="og:description" content={desc} />
		
		<link rel="icon" href="/favicon.ico" />

		<script>
			document.documentElement.classList.toggle("dark",
				localStorage.theme === "dark" || (!("theme" in localStorage) && window.matchMedia("(prefers-color-scheme: dark)").matches)
			);
		</script>
	</head>
	<body class={`relative ${bg === "rock" ? "bg-rock-100" : "bg-white"} dark:bg-rock-950 dark:text-rock-100 overflow-x-hidden`}>
		<div class="absolute top-0 right-4 z-10 flex items-start gap-2 text-lg">
			<button
				class="group px-1.5 pt-6 pb-1 bg-gray-500/5 border-[1.5px] border-t-0 border-gray-500 rounded-b-full cursor-pointer -translate-y-4 hover:translate-y-0 hover:border-dashed transition"
				id="themeToggleLock" title="Follow system theme"
			>
				üîÆ
			</button>
			<button
				class="group px-1.5 pt-6 pb-1 bg-orange-500/5 border-[1.5px] border-t-0 border-orange-500 rounded-b-full dark:cursor-pointer dark:-translate-y-4 dark:hover:translate-y-0 transition"
				id="themeToggleLight" title="Light theme"
			>
				‚òÄÔ∏è
			</button>
			<button
				class="group px-1.5 pt-6 pb-1 bg-purple-500/5 border-[1.5px] border-t-0 border-purple-500 rounded-b-full cursor-pointer dark:cursor-auto -translate-y-4 dark:translate-y-0 hover:translate-y-0 transition"
				id="themeToggleDark" title="Dark theme"
			>
				üåë
			</button>
		</div>

		<slot />

		<script>
			const toggleLock = document.getElementById("themeToggleLock") as HTMLButtonElement;
			const toggleLight = document.getElementById("themeToggleLight") as HTMLButtonElement;
			const toggleDark = document.getElementById("themeToggleDark") as HTMLButtonElement;
			
			if(!("theme" in localStorage)) toggleLock.classList.add("hidden");
			toggleLight.disabled = !document.documentElement.classList.contains("dark");
			toggleDark.disabled = document.documentElement.classList.contains("dark");
			
			toggleLock.addEventListener("click", () => {
				localStorage.removeItem("theme");
				document.documentElement.classList.toggle("dark", window.matchMedia("(prefers-color-scheme: dark)").matches);
				toggleLock?.classList.add("hidden");
				toggleLight.disabled = !document.documentElement.classList.contains("dark");
				toggleDark.disabled = document.documentElement.classList.contains("dark");
			});

			toggleLight.addEventListener("click", () => {
				localStorage.theme = "light";
				document.documentElement.classList.remove("dark");
				toggleLock.classList.remove("hidden");
				toggleLight.disabled = true;
				toggleDark.disabled = false;
			});

			toggleDark.addEventListener("click", () => {
				localStorage.theme = "dark";
				document.documentElement.classList.add("dark");
				toggleLock.classList.remove("hidden");
				toggleDark.disabled = true;
				toggleLight.disabled = false;
			});
		</script>

		<Analytics />
		<SpeedInsights />
	</body>
</html>
